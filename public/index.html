<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>React Feedback Form</title>
    <!-- React and ReactDOM CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { useState } = React;

      function App() {
        const [name, setName] = useState("");
        const [message, setMessage] = useState("");
        const [status, setStatus] = useState("");

        const submitFeedback = async () => {
          if (!name || !message) {
            setStatus("Please fill in all fields.");
            return;
          }

          const payload = { name, message };

          try {
            const res = await fetch("/.netlify/functions/feedback", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(payload),
            });

            if (res.ok) {
              setStatus("Feedback sent! Thank you.");
              setName("");
              setMessage("");
            } else {
              setStatus("Error sending feedback.");
            }
          } catch (err) {
            setStatus("Error sending feedback.");
            console.error(err);
          }
        };

        return (
          <div style={{ padding: "20px", maxWidth: "400px", margin: "auto" }}>
            <h2>Feedback Form</h2>
            <input
              value={name}
              onChange={(e) => setName(e.target.value)}
              placeholder="Your Name"
              style={{ width: "100%", marginBottom: "10px" }}
            />
            <textarea
              value={message}
              onChange={(e) => setMessage(e.target.value)}
              placeholder="Your Feedback"
              style={{ width: "100%", marginBottom: "10px" }}
            ></textarea>
            <button onClick={submitFeedback}>Submit</button>
            <p>{status}</p>
          </div>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
